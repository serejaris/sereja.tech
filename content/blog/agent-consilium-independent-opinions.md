---
title: "Консилиум: три агента нашли разные проблемы в проекте"
date: 2026-02-16
description: "Субагенты в Claude Code могут не только выполнять задачи, но и давать независимые экспертные оценки. Паттерн консилиума + промпт, который можно скопировать."
tags: ["claude-code", "субагенты", "вайбкодинг", "принятие-решений"]
---

Когда нужно принять сложное решение по проекту, обычно просишь агента: "Что думаешь?" Получаешь один ответ. Вежливый, структурированный, с bullet points. И без альтернативной точки зрения.

Я попробовал иначе. Показал текущее состояние кружка вайбкодинга нескольким субагентам и попросил каждого дать независимую оценку. Не выполнить задачу — а высказаться. Как врачи на консилиуме: каждый смотрит на одного пациента, но видит своё.

За полтора часа получил план действий, который зафиксировал в GitHub Issues. Не "можно попробовать", а конкретные задачи с приоритетами.

## Консилиум — это не Agent Teams

[Agent Teams](/blog/agent-teams-opus-4-6) — команда, которая работает вместе. Один делает backend, другой frontend, третий тесты. Цель — скорость.

Консилиум — про другое. Несколько экспертов смотрят на одну проблему, каждый в изоляции. Не координируются. Не знают о мнениях друг друга. Цель — качество решения.

```
AGENT TEAMS                        КОНСИЛИУМ
─────────────                      ──────────
Параллельное ВЫПОЛНЕНИЕ            Параллельный АНАЛИЗ

┌──────────┐                       ┌──────────┐
│ Agent 1  │──── shared ────│Agent 2│  │Expert 1 │──── независимо
│ backend  │     task list  │frontend│  │ UX      │
└──────────┘                └───────┘  └────┬────┘
      │                                     │
      └──── координация ────┘               │ ?
                                            │
                                       ┌────┴────┐
                                       │Expert 2 │──── независимо
                                       │ бизнес  │
                                       └────┬────┘
                                            │
                                            ▼
                                       ┌─────────┐
                                       │ Синтез  │
                                       │ решение │
                                       └─────────┘

Цель: скорость                     Цель: качество решения
```

В медицине это устоявшаяся практика. Консилиум — когда несколько врачей разных специальностей независимо оценивают случай. Онколог, хирург, радиолог. Каждый видит своё. Решение — на пересечении мнений.

[Andrej Karpathy](https://github.com/karpathy/llm-council) формализовал похожий паттерн для LLM: несколько моделей дают независимые ответы, потом peer review, потом Chairman синтезирует. MIT Media Lab пошли дальше — [MDAgents](https://arxiv.org/abs/2410.02998) эмулирует реальный медицинский консилиум, автоматически выбирая между solo-решением и групповым обсуждением.

Идея не новая. Новое — что это можно сделать за один промпт в Claude Code.

## Как это выглядело

Кружок вайбкодинга. Есть бот, уроки, платежи, прогресс учеников. Работает, но хаотично. Я хотел понять: что хорошо, что плохо, и куда двигаться дальше.

Первый промпт — попросил агента нарисовать текущую архитектуру.

{{< callout type="insight" >}}
Нарисуй, как это будет работать. В виде ASCII-диаграммы.
{{< /callout >}}

Получил картину. Увидел масштаб. И понял, что одного мнения мне мало.

{{< callout type="insight" >}}
Вот так выглядит сейчас. Что хорошо, что плохо? Нужен консилиум независимых экспертов через субагентов, и после — план действий.
{{< /callout >}}

Claude Code запустил несколько субагентов через Task tool. Каждый получил одинаковый контекст — текущее состояние проекта. Но разный фокус: один смотрел на архитектуру, другой на UX, третий на бизнес-логику.

Тут принципиально слово "независимых". Субагенты не видят ответы друг друга. Каждый анализирует с нуля, без влияния предыдущих оценок. Параллельная экспертиза, не дискуссия.

## Почему независимость важна

Когда спрашиваешь одного агента "что плохо?", он выдаёт список. Аккуратный, без конфликтов с самим собой. Одна перспектива.

Когда пять экспертов смотрят независимо — они находят разное. UX-эксперт видит проблемы в онбординге, которые архитектор не замечает. Бизнес-аналитик задаёт вопрос про unit-экономику, который технарь не задаст.

На [ICLR 2026 представили Multi-Agent-as-Judge](https://openreview.net/forum?id=Rx4RIf0bMO) — фреймворк, где агенты с разными персонами дебатируют и дают многомерную обратную связь. Вывод простой: разные точки зрения ловят разные проблемы.

Похожий принцип я использую в [пайплайне деаификации текста](/blog/multi-agent-text-deaify) — три параллельных критика находят разные проблемы, которые один rewriter пропустил бы. Но там критики проверяют текст. Здесь — оценивают проект целиком.

## Валидация через research

После консилиума у меня был список рекомендаций. Но рекомендации от LLM — это утверждения, не факты. Нужна проверка.

{{< callout type="insight" >}}
Можешь по каждой из этих задач провести research через Exa MCP, чтобы понять, насколько это вообще необходимо.
{{< /callout >}}

Агент взял каждую рекомендацию консилиума и проверил через веб-поиск. Нужна ли прогресс-система для учеников? Что говорят исследования про вовлечённость? Какие метрики отслеживать?

Без этого шага консилиум — просто мнения. А мнения без фактов — галлюцинации в красивой обёртке. Похожий подход использовал для [контент-плана с субагентами и Exa MCP](/blog/content-plan-subagents-exa) — там тоже сначала идея, потом проверка через поиск.

## От мнений к задачам

Проверенные рекомендации — ещё не план. Нужно превратить их в конкретные задачи.

{{< callout type="insight" >}}
Давай через brainstorm сделаем для каждой из этих задач план и запишем в GitHub Issues, чтобы потом подхватить.
{{< /callout >}}

И дальше — с проверкой:

{{< callout type="insight" >}}
Ну давай через субагентов с проверкой, если можно.
{{< /callout >}}

Агент разбил каждую рекомендацию на задачи, провёл brainstorm по каждой через субагентов, и записал результаты в GitHub Issues. С описанием, контекстом, и обоснованием.

Весь пайплайн за сессию:

```
┌────────────────┐
│   Диаграмма    │  Промпт 1: "нарисуй как сейчас"
│   текущего     │
│   состояния    │
└───────┬────────┘
        │
        ▼
┌────────────────┐
│   Консилиум    │  Промпт 2: "независимые эксперты"
│   5 экспертов  │
│   параллельно  │──── каждый НЕ видит других
└───────┬────────┘
        │
        ▼
┌────────────────┐
│   Research     │  Промпт 3: "проверь через поиск"
│   по каждой    │
│   рекомендации │──── факты, не мнения
└───────┬────────┘
        │
        ▼
┌────────────────┐
│   Brainstorm   │  Промпт 4-5: "план → issues"
│   + GitHub     │
│   Issues       │──── конкретные задачи
└────────────────┘

Сессия: 92 мин, 15 промптов
```

92 минуты. 15 промптов. На выходе — набор задач в GitHub Issues, проверенных через research и разложенных на шаги. Не "идеи на подумать", а backlog.

## Когда консилиум, а когда хватит одного агента

Консилиум нужен не всегда. Вот как я это разделяю:

| Ситуация | Подход |
|----------|--------|
| Баг в коде | Один агент, без консилиума |
| Архитектурное решение | Консилиум: архитектор + UX + бизнес |
| Написать тест | Один агент |
| Стратегия развития проекта | Консилиум + research |
| Рефакторинг одного модуля | Один агент |
| Аудит перед масштабированием | Консилиум |

Простое правило: если решение обратимо за пять минут — один агент. Если ошибка стоит дней работы — консилиум.

## Промпт для копирования

Вот промпт, который запускает консилиум. Адаптируй под свой проект — замени контекст и роли экспертов.

{{< callout type="insight" >}}
Мне нужен консилиум независимых экспертов по проекту [название].

Вот текущее состояние: [описание или путь к файлам].

Запусти через субагентов 4-5 экспертов с разными фокусами:
— Архитектура и технический долг
— UX и пользовательский опыт
— Бизнес-логика и масштабируемость
— Безопасность и надёжность
— [добавь свою специализацию]

Каждый должен работать НЕЗАВИСИМО, не видя ответов других. Для каждого: что хорошо, что плохо, топ-3 рекомендации с приоритетом.

После — синтез: где мнения совпали (высокий приоритет), где разошлись (нужна дискуссия), итоговый план действий.
{{< /callout >}}

Без слова "независимо" агент может запустить экспертов последовательно — и каждый следующий подстроится под предыдущего. Вся суть ломается. Независимость работает только через параллельные субагенты, каждый в своём контексте.

## Что я понял

**Субагенты — не только руки, но и головы.** До этой сессии я воспринимал субагентов как исполнителей: разбей на куски, обработай, собери. Похожий подход описывал для [четырёх параллельных критиков в eval-пайплайне](/blog/llm-evals-for-vibecoder). Но консилиум — другое. Здесь субагенты не делают — они думают. Не выполняют задачу, а формируют мнение.

**Качество — через множественность.** Один эксперт даёт одну перспективу. Пять независимых — пять перспектив, и на пересечении мнений оказывается то, что реально важно. А расхождения — сигнал копать глубже.

**Research после мнений, не вместо.** Консилиум без проверки — пять галлюцинаций вместо одной. Мнения экспертов → проверка фактов → план действий.

**Результат — не текст, а задачи.** Красивый отчёт "что хорошо, что плохо" бесполезен, если через неделю забыл половину. А задача в GitHub Issues — уже обязательство.

## Частые вопросы

### Чем консилиум отличается от обычного "дай несколько мнений"?

Независимостью. "Дай три мнения" — один агент генерирует три варианта последовательно. Каждый следующий знает про предыдущий и подстраивается. Консилиум — параллельные субагенты, каждый в своём контексте. Разница как между одним врачом, который предлагает три варианта, и тремя врачами, которые смотрят случай отдельно.

### Сколько экспертов нужно?

Три-пять. Меньше — мало перспектив. Больше — синтез становится сложным и дорогим по токенам. Четыре — мой дефолт.

### Это работает только в Claude Code?

Нет. Паттерн — параллельные независимые оценки + синтез. Реализуется в любом инструменте с субагентами или параллельными запросами. Claude Code удобен тем, что субагенты запускаются через Task tool и работают в изолированных контекстах.

### Не дорого ли запускать 5 субагентов?

Дороже одного — да. Но дешевле ошибочного архитектурного решения. Консилиум из пяти субагентов на Haiku обходится в центы. На Opus — в доллары, но для стратегических решений это окупается за первую же предотвращённую переделку.
